# 滑动手势功能测试指南

## 🎯 功能说明

真题练习系统支持滑动手势切换题目:

- **向左滑动 ◀**: 返回上一题
- **向右滑动 ▶**: 前进到下一题

## 📱 测试步骤

### 测试1: 基本滑动功能

1. **启动应用**
   - 打开APP,点击"真题练习"
   - 进入Section提示页,点击"开始答题"
   - 现在在第1题

2. **测试向右滑动(下一题)**
   ```
   在第1题的文章区域:
   ├─ 从左向右快速滑动 ▶
   ├─ 应看到Toast提示: "下一题 ▶"
   └─ 题号显示变为: 2/52
   ```

3. **测试向左滑动(上一题)**
   ```
   在第2题的文章区域:
   ├─ 从右向左快速滑动 ◀
   ├─ 应看到Toast提示: "◀ 上一题"
   └─ 题号显示变为: 1/52
   ```

### 测试2: 边界条件测试

4. **测试第一题向左滑动**
   ```
   在第1题:
   ├─ 向左滑动 ◀
   └─ 应看到Toast: "已经是第一题了"
   ```

5. **测试最后一题向右滑动**
   ```
   先点击题号52跳到最后:
   ├─ 向右滑动 ▶
   └─ 应看到Toast: "已经是最后一题了"
   ```

### 测试3: 滑动区域测试

6. **在文章区域滑动**
   ```
   ✅ 应该能正常切换题目
   ```

7. **在底部选项窗口滑动**
   ```
   ❓ 不应触发题目切换(底部窗口有自己的滚动)
   ```

### 测试4: 与垂直滚动的兼容性

8. **垂直滚动文章**
   ```
   文章较长时:
   ├─ 上下滑动阅读文章
   └─ ✅ 应该能正常滚动,不触发题目切换
   ```

9. **斜向滑动**
   ```
   既向右又向下滑动:
   ├─ 如果水平分量 > 垂直分量
   ├─ ✅ 应触发题目切换
   └─ 否则应触发垂直滚动
   ```

### 测试5: 与其他功能的兼容性

10. **选择答案后自动跳转**
    ```
    1. 点击选项A
    2. 等待800ms自动跳转到下一题
    3. 在新题目上向左滑动 ◀
    4. ✅ 应该能返回上一题
    ```

11. **底部窗口状态保持**
    ```
    1. 向上拖动底部窗口完全展开
    2. 向右滑动 ▶ 到下一题
    3. ✅ 底部窗口应保持展开状态
    ```

12. **点击题号跳转**
    ```
    1. 点击题号5
    2. 跳转到第5题
    3. 向左滑动 ◀ → 第4题
    4. 向右滑动 ▶ → 第5题
    5. ✅ 应该流畅切换
    ```

## 🔍 调试检查点

### 检查点1: 手势是否被正确检测

**日志输出**:
```java
// 在onFling方法中添加日志
Log.d("GestureDetector", "diffX: " + diffX + ", velocityX: " + velocityX);
```

**预期结果**:
- 向右滑: `diffX > 0` (正数)
- 向左滑: `diffX < 0` (负数)

### 检查点2: 阈值是否合理

当前设置:
- 滑动距离阈值: **100像素**
- 滑动速度阈值: **100像素/秒**

**测试**:
- 如果滑动不敏感,减小阈值(如50)
- 如果误触频繁,增大阈值(如150)

### 检查点3: TouchListener是否正确绑定

**检查代码**:
```java
scrollView.setOnTouchListener((v, event) -> {
    boolean gestureHandled = gestureDetector.onTouchEvent(event);
    if (gestureHandled) {
        return true; // 阻止ScrollView滚动
    }
    return false; // 允许ScrollView滚动
});
```

## ⚠️ 常见问题排查

### 问题1: 滑动不响应

**可能原因**:
- [ ] 手势检测器未初始化
- [ ] TouchListener未绑定到ScrollView
- [ ] onDown()方法未返回true

**解决方法**:
```java
// 确保onCreate中调用了
setupGestureDetector();

// 确保onDown返回true
@Override
public boolean onDown(MotionEvent e) {
    return true; // 必须返回true
}
```

### 问题2: 滑动方向相反

**检查代码**:
```java
if (diffX > 0) {
    // 向右滑动 -> 下一题 ✅
    swipeToNextQuestion();
} else {
    // 向左滑动 -> 上一题 ✅
    swipeToPreviousQuestion();
}
```

### 问题3: 垂直滚动被阻止

**检查代码**:
```java
// 判断是否为水平滑动
if (Math.abs(diffX) > Math.abs(diffY)) {
    // 只有水平分量大于垂直分量才切换题目
}
```

### 问题4: Toast不显示

**检查方法调用**:
```java
Toast.makeText(RealExamActivity.this, "◀ 上一题", Toast.LENGTH_SHORT).show();
                                    ↑ 注意Context
```

## 📊 测试记录表

| 测试项 | 预期结果 | 实际结果 | 通过 |
|--------|----------|----------|------|
| 向右滑动到下一题 | 题号+1 | | ☐ |
| 向左滑动到上一题 | 题号-1 | | ☐ |
| 第一题向左滑动 | 提示"已是第一题" | | ☐ |
| 最后题向右滑动 | 提示"已是最后题" | | ☐ |
| Toast提示正确 | 显示箭头图标 | | ☐ |
| 垂直滚动正常 | 文章可上下滚动 | | ☐ |
| 底部窗口状态保持 | 展开状态不变 | | ☐ |
| 自动跳转兼容 | 两功能都正常 | | ☐ |
| 题号自动滚动 | 当前题号可见 | | ☐ |
| 性能流畅 | 无卡顿 | | ☐ |

## 🎯 性能测试

### 测试1: 快速连续滑动
```
1. 从第1题开始
2. 快速向右滑动10次
3. 应该到达第11题
4. 观察是否有卡顿或丢失滑动
```

### 测试2: 内存占用
```
1. 打开Android Studio Profiler
2. 记录滑动前的内存使用
3. 连续滑动50次
4. 检查内存是否有异常增长
```

### 测试3: 响应时间
```
1. 从滑动开始到Toast显示
2. 应该 < 100ms
3. 从滑动开始到题目切换完成
4. 应该 < 200ms
```

## ✅ 验收标准

功能视为完成,需满足:

1. ✅ **基本功能**: 向左/向右滑动能正确切换题目
2. ✅ **视觉反馈**: Toast提示清晰,带方向箭头
3. ✅ **边界处理**: 第一题和最后一题有友好提示
4. ✅ **不冲突**: 不影响垂直滚动和其他功能
5. ✅ **性能良好**: 流畅无卡顿,内存稳定
6. ✅ **直观易用**: 用户无需学习即可使用

## 🎓 用户培训要点

虽然手势直观,但可以在首次使用时提示:

**提示文案**:
```
💡 小提示:
向左滑动 ◀ 查看上一题
向右滑动 ▶ 查看下一题
```

**显示位置**: 
- 首次进入答题页面时
- 使用SnackBar或Dialog提示
- 提供"不再提示"选项

## 📝 测试报告模板

```markdown
### 滑动手势功能测试报告

**测试日期**: 2025-XX-XX
**测试人员**: XXX
**测试设备**: XXX
**Android版本**: XXX

#### 测试结果
- 基本滑动功能: ✅/❌
- 边界条件处理: ✅/❌
- 与垂直滚动兼容: ✅/❌
- 性能表现: ✅/❌

#### 发现的问题
1. 问题描述...
2. 复现步骤...

#### 建议
XXX
```

---

**测试完成后请标记**: ✅ 所有测试通过,功能可用

