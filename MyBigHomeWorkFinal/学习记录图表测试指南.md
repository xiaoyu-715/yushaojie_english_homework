# 📊 学习记录图表测试指南

## 🎯 测试目标

验证学习记录图表功能是否正常工作，包括数据读取、图表绘制、样式展示等。

---

## ✅ 测试前准备

### 1. 确保项目编译成功
```bash
./gradlew clean
./gradlew assembleDebug
```

### 2. 确保数据库中有学习记录数据
如果数据库中没有数据，图表将显示默认的空数据图表（所有数据点为0）。

---

## 🧪 测试用例

### 测试用例1：空数据显示测试

**测试步骤：**
1. 清空数据库或使用新设备
2. 启动应用
3. 进入学习报告页面

**期望结果：**
- ✅ 图表正常显示
- ✅ 显示最近7天的日期标签
- ✅ 曲线为水平直线（所有值为0）
- ✅ 当日标签显示为橙色"今日"
- ✅ 显示"当日学习时长: 0s"

---

### 测试用例2：有数据显示测试

**测试步骤：**
1. 进行一些学习活动（词汇训练、真题练习等）
2. 返回学习报告页面
3. 观察图表变化

**期望结果：**
- ✅ 图表显示有起伏的曲线
- ✅ 当日数据点比其他数据点更大
- ✅ 数据点外圈为白色，内圈为橙色
- ✅ 曲线为橙色（#FF9A6C）
- ✅ 曲线下方有半透明橙色填充
- ✅ 当日学习时长正确显示

---

### 测试用例3：时长格式化测试

**测试场景：**

| 学习时长（秒） | 期望显示格式 |
|--------------|------------|
| 0 | 0s |
| 45 | 45s |
| 60 | 1m |
| 150 | 2m30s |
| 3600 | 1h |
| 3900 | 1h5m |
| 7200 | 2h |

**测试方法：**
通过不同时长的学习活动，验证时长显示格式是否正确。

---

### 测试用例4：多日数据测试

**测试步骤：**
1. 在不同的日期进行学习活动
2. 查看图表是否正确显示多日数据

**期望结果：**
- ✅ 正确显示最近7天的数据
- ✅ 日期标签按时间顺序排列
- ✅ 曲线连接所有数据点
- ✅ 填充区域正确覆盖曲线下方

---

### 测试用例5：页面刷新测试

**测试步骤：**
1. 进入学习报告页面
2. 退出到主页
3. 进行一些学习活动
4. 再次进入学习报告页面

**期望结果：**
- ✅ 图表数据自动更新
- ✅ 显示最新的学习时长
- ✅ 无需手动刷新

---

### 测试用例6：横屏适配测试

**测试步骤：**
1. 进入学习报告页面
2. 旋转设备到横屏模式
3. 观察图表显示

**期望结果：**
- ✅ 图表自动适配横屏尺寸
- ✅ 所有元素正常显示
- ✅ 无变形或错位

---

### 测试用例7：不同屏幕尺寸测试

**测试设备：**
- 小屏手机（4.7英寸）
- 中屏手机（5.5-6.0英寸）
- 大屏手机（6.5英寸以上）
- 平板设备

**期望结果：**
- ✅ 在所有设备上正常显示
- ✅ 文字大小清晰可读
- ✅ 图表比例协调

---

## 🐛 常见问题排查

### 问题1：图表不显示

**可能原因：**
- 布局文件路径错误
- 自定义View未正确注册
- 数据加载失败

**排查方法：**
1. 检查 `activity_report.xml` 中的图表ID
2. 检查 `ReportActivity.java` 中是否正确初始化
3. 查看Logcat日志，寻找异常信息

---

### 问题2：图表显示异常

**可能原因：**
- 数据格式不正确
- 绘制逻辑错误
- 内存不足

**排查方法：**
1. 在 `setData` 方法中添加日志，检查传入的数据
2. 检查数据点数量和日期标签数量是否一致
3. 检查是否有数组越界或空指针异常

---

### 问题3：时长显示不准确

**可能原因：**
- 数据库查询逻辑错误
- 时间单位转换错误

**排查方法：**
1. 检查数据库中的学习记录数据
2. 验证SQL查询结果
3. 检查时间单位转换逻辑（毫秒→秒）

---

### 问题4：图表性能问题

**可能原因：**
- 数据量过大
- 绘制过于频繁
- 未使用硬件加速

**解决方法：**
1. 限制数据点数量（目前为7天）
2. 避免频繁调用 `setData` 方法
3. 启用硬件加速（默认已启用）

---

## 📝 测试日志模板

```
测试日期：____年__月__日
测试人员：__________
测试设备：__________
Android版本：__________

测试用例1：空数据显示测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例2：有数据显示测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例3：时长格式化测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例4：多日数据测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例5：页面刷新测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例6：横屏适配测试
[ ] 通过  [ ] 失败
备注：_________________

测试用例7：不同屏幕尺寸测试
[ ] 通过  [ ] 失败
备注：_________________

总体评价：
_______________________
_______________________
_______________________
```

---

## 🎯 自动化测试建议

### UI测试脚本（Espresso）

```java
@Test
public void testStudyChartDisplayed() {
    // 启动ReportActivity
    ActivityScenario.launch(ReportActivity.class);
    
    // 检查图表是否显示
    onView(withId(R.id.study_chart))
        .check(matches(isDisplayed()));
}

@Test
public void testChartDataUpdate() {
    // 添加学习记录
    addStudyRecord();
    
    // 启动ReportActivity
    ActivityScenario.launch(ReportActivity.class);
    
    // 等待数据加载
    Thread.sleep(2000);
    
    // 验证图表已更新（可以通过截图对比）
    onView(withId(R.id.study_chart))
        .check(matches(isDisplayed()));
}
```

---

## ✅ 测试验收标准

所有测试用例通过，且满足以下条件：

- ✅ 图表在所有测试设备上正常显示
- ✅ 数据准确无误
- ✅ 时长格式化正确
- ✅ 样式符合设计要求
- ✅ 无性能问题
- ✅ 无内存泄漏
- ✅ 无崩溃或ANR

---

## 📞 问题反馈

如果在测试过程中发现任何问题，请提供以下信息：

1. **问题描述**：详细描述问题现象
2. **重现步骤**：列出问题重现的步骤
3. **期望结果**：描述期望的正确结果
4. **实际结果**：描述实际看到的结果
5. **设备信息**：设备型号、Android版本等
6. **日志信息**：Logcat日志或截图

---

## 🎉 测试完成

恭喜！如果所有测试用例都通过，说明学习记录图表功能已成功实现并可以正常使用。

